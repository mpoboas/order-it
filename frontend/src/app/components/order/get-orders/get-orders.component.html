<div class="p-card my-4 p-[2rem] border-md">
    <p-table [value]="orders" dataKey="orderNumber" [tableStyle]="{ 'min-width': '60rem' }" class="min-w-full">
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 5rem"></th>
                <th pSortableColumn="orderNumber"># Pedido <p-sortIcon field="orderNumber"></p-sortIcon></th>
                <th>Nota do pedido</th>
                <th>Pagar a</th>
                <th>Total</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-order let-expanded="expanded">
            <tr>
                <td>
                    <button type="button" pButton pRipple [pRowToggler]="order" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                </td>
                <td>{{ order.orderNumber }}</td>
                <td>{{ order.orderNote }}</td>
                <td>{{ order.payerName }}</td>
                <td>{{ calculateTotal(order) | currency: 'EUR' }}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-order>
            <tr>
                <td colspan="6">
                    <div class="p-3">
                        <p-table [value]="order.items" dataKey="itemId">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th pSortableColumn="itemName">Produto <p-sortIcon field="itemName"></p-sortIcon></th>
                                    <th pSortableColumn="itemBrandType">Tipo de Marca <p-sortIcon field="itemBrandType"></p-sortIcon></th>
                                    <th pSortableColumn="itemUnitsQuantity">Quantidade <p-sortIcon field="itemUnitsQuantity"></p-sortIcon></th>
                                    <th pSortableColumn="itemPrice">Preço <p-sortIcon field="itemPrice"></p-sortIcon></th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-item>
                                <tr>
                                    <td>{{ item.itemName }}</td>
                                    <td>{{ item.itemBrandType }}</td>
                                    <td>{{ item.itemUnitsQuantity }}</td>
                                    <td>{{ item.itemPrice | currency: 'EUR' }}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="4">Este pedido não tem itens.</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>